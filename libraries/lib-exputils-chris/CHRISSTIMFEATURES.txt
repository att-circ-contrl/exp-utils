Stimulation response features are stored as a structure with the following
fields. Each response describes one trial (or one timelock-average from a
set of trials); responses for multiple trials are typically returned as a
cell array of per-trial responses.



== Fields common to all types of feature extraction:


General metadata:

"trialnum" is the trial number.

"winbefore" is a scalar containing the timestamp of the midpoint of the
  before-stimulation time window, in seconds.

"winafter" is a 1 x Nwindows matrix containing the timestamps of the
  midpoints of the after-stimulation time windows, in seconds.

(Time window durations are not stored in this structure.)



Metadata labels expected by euPlot_plotResponseStatistics:

"sessionlabel" is a character vector containing a filename-safe label for
  the recording session (e.g. '20230808a').

"caselabel" is a character vector containing a filename-safe label for the
  group of trials that was aggregated (typically corresponding to one set
  of test conditions; e.g. 'be150rand').

"probelabel" is a character vector containing a filename-safe label for the
  group of channels being processed (typically corresponding to one probe;
  e.g. 'pr1acc').

"chanlabels" is a cell array containing Field Trip channel labels for each
  of the channels in this response.

"chanidx" is a Nchans x 1 matrix containing sequentially numbered channel
  indices. This is used as a data series to plot data against channel index.

"winidx" is a 1 x Nwindows matrix containing sequentially numbered window
  indices. This is used as a data series to plot data against window nuimber.



Normalized data fields that may be provided by test scripts:

"FOOnormCASE" a Nchans x Nwindows matrix containing an extracted feature
  value (FOO) normalized against that feature's value from a baseline test
  case, for each channel and each requested window location.

"FOObaseCASE" is a Nchans x Nwindows matrix containing the extracted
  feature value that was normalized against, corresponding to each
  "FOOnormCASE" entry above. This is the feature value from a different
  case (the baseline case).

These are typically generated by "euChris_calcNormalizedResponse".

NOTE - Any normalized data with negligible or noisy baseline values will be
meaningless. Pruning such cases is strongly advised.




== Fields for local field potential oscillations:


Fields provided by euChris_extractStimOscillationResponse:

"oscfreq" is the dominant frequency detected in the trial.

"magbefore" is a Nchans x 1 matrix containing magnitudes of the dominant
  oscillation before stimulation for each channel.

"freqbefore" is a Nchans x 1 matrix containing frequencies of the dominant
  oscillation before stimulation for each channel.

"phasebefore" is a Nchans x 1 matrix containing the phase (in radians) of
  the dominant oscillation before stimulation for each channel at the
  window midpoint.

"meanbefore" is a Nchans x 1 matrix containing the DC offset (mean) of the
  wave in the "before stimulation" curve fit window.

"rampbefore" (optional) is a Nchans x 1 matrix containing the line-fit slope
  of the wave in the "before stimulation" curve fit window.

"magafter" is a Nchans x Nwindows matrix containing magnitudes of the
  dominant oscillation after stimulation for each channel and each
  requested window location.

"freqafter" is a Nchans x Nwindows matrix containing frequencies of the
  dominant oscillation after stimulation for each channel and each
  requested window location.

"phaseafter" is a Nchans x Nwindows matrix containing the phase (in
  radians) of the dominant oscillation after stimulation for each
  channel at each requested window midpoint.

"meanafter" is a Nchans x Nwindows matrix containing the DC offset (mean)
  of the wave in each "after stimulation" curve fit window.

"rampafter" (optional) is a Nchans x Nwindows matrix containing the line-fit
  slope of the wave in each "after stimulation" curve fit window.

"relafter" is a Nchans x Nwindows matrix containing relative magnitudes
  of the dominant oscillation after stimulation dividied by the magnitude
  before stimulation, for each channel and each requested window
  location. If the oscillation before stimulation was below-threshold,
  NaN is recorded instead of the relative magnitude.



Debugging fields that may be provided (if requested):

"origtimebefore" is a 1 x Nsamples matrix containing timestamps from the
  "before stimulation" curve fit window.

"origwavebefore" is a Nchans x Nsamples matrix with waveform data from the
  "before stimulation" curve fit window.

"rawphasebefore" is a Nchans x 1 matrix storing the phase returned by
  nlProc_fitCosine() before adjustment.

"origtimeafter" is a cell array with one entry per window size, containing
  1 x Nsamples matrices holding timestamps from the "after stimulation"
  curve fit windows.

"origwaveafter" is a cell array with one entry per window size, containing
  Nchans x Nsamples matrices holding waveform data from the "after
  stimulation" curve fit windows.

"rawphaseafter" is a cell array with one entry per window size, containing
  Nchans x 1 matrices storing the phase returned by nlProc_fitCosine()
  before adjustment.



Normalized data fields that are generated by test scripts:

"magafternormrand" and "magafterbaserand" contain magnitudes of the dominant
  oscillation after phase-specific stimulation normalized against the
  corresponding random-phase stimulation cases.

"magafternormphase" and "magafterbasephase" contain magnitudes of the dominant
  oscillation after stimulation at one specific phase (typically 180 degrees)
  normalized against another specific phase (typically 0 degrees).

"magafternormcurrent" and "magafterbasecurrent" contain magnitudes of the
  dominant oscillation after stimulation at higher current normalized against
  lower current (typically sham if available).

"relafternormcurrent" and "relafterbasecurrent" contain the after-vs-before
  relative oscillation magnitudes at higher current normalized against the
  relative oscillation magnitudes at lower current.




== Fields for multi-unit activity:


Raw statistics provided by euChris_extractStimMUAResponse:

"meanbefore" is a Nchans x 1 vector holding the mean of the MUA before
  stimulation.

"meanafter_list" is a Nchans x Nwindows matrix containing means of the MUA
  after stimulation.

"devbefore" is a Nchans x 1 vector holding the standard deviation of the
  MUA before stimulation.

"devafter_list" is a Nchans x Nwindows matrix containing standard deviations
  of the MUA after stimulation.



Derived statistics provided by euChris_extractStimMUAResponse:

"basemult_list" is a Nchans x Nwindows matrix containing
  meanafter / meanbefore. This is the relative increase in background
  activity.

"devmult_list" is a Nchans x Nwidnows matrix containing
  devafter / devbefore. This is the relative increase in activity
  _variability_.

"zbaseshift_list" is a Nchans x Nwindows matrix containing
  (meanafter - meanbefore) / devbefore. This is the z-scored _displacement_
  in background activity.

"zdevmean_list" is a Nchans x Nwindows matrix containing
  devafter / meanbefore. This is the normalized _variability_ in the
  background activity.


If noise is negligible and spiking activity is the dominant component of
the background, then "basemult" is a z-scored measure of activity change.

If noise is the dominant component of the background and real spiking
activity is intermittent, "devmult" is a z-scored measure of activity change.

If the noise component of the background is the same before and after
stimulation, and if spiking activity is a significant component of the
background, then "zbaseshift" is a z-scored measure of activity change.

If spiking activity is highly variable but the background level is
consistent, then "zdevmean" is a normalized measurement of variability
(variation in before-stimulation activity prevents true z-scoring).



Normalized data fields that are generated by test scripts:

These fields have names with the form:
{ (statistic) }{ norm | base }{ abs | rand | phase | current }

Where (statistic) is:
{ meanafter| devafter | basemult | devmult | zbaseshift | zdevmean }

"basemultFOO", "devmultFOO", "zbaseshiftFOO", and so forth are derived from
  the corresponding statistics described above.

"FOOnormCASE" and "FOObaseCASE" are the normalized statistic value and the
  baseline statistic value (used to compute the normalized value),
  respectively.

"FOOrand" uses the random-phase test case as the baseline, dividing other
  phase cases' statistic values by the random-phase case's value.
"FOOphase" uses the "n90" phase test case as the baseline, dividing the
  other fixed-phase cases' statistic values by the "n90" case's value.
"FOOcurrent" uses the sham case as the baseline, dividing the other current
  cases' statistic values by the sham case's value.
"FOOabs" is a raw value that isn't divided by a baseline statistic.



(This is the end of the file.)
